(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{508:function(t,a,s){t.exports=s.p+"assets/img/wave.54fdc171.png"},612:function(t,a,s){"use strict";s.r(a);var e=s(24),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"wave-effect"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#wave-effect"}},[t._v("#")]),t._v(" Wave Effect")]),t._v(" "),e("p",[t._v("In this more complex example, we will create a wave effect with the fragment shader. The waveform is based on the sinus curve and it influences the texture coordinates used for the color.")]),t._v(" "),e("p",[t._v("The qml file defines the properties and animation.")]),t._v(" "),e("div",{staticClass:"language-qml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-qml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" QtQuick 2.5\n\n"),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Rectangle")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("width")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token javascript-expression language-javascript"}},[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("480")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("height")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token javascript-expression language-javascript"}},[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("240")])]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("color")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token javascript-expression language-javascript"}},[e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#1e1e1e'")])]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Row")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("anchors.centerIn")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token javascript-expression language-javascript"}},[t._v("parent")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("spacing")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token javascript-expression language-javascript"}},[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")])]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Image")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("id")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token javascript-expression language-javascript"}},[t._v("sourceImage")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("width")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token javascript-expression language-javascript"}},[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("160")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("height")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token javascript-expression language-javascript"}},[t._v("width")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("source")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token javascript-expression language-javascript"}},[e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"../assets/coastline.jpg"')])]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ShaderEffect")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("width")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token javascript-expression language-javascript"}},[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("160")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("height")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token javascript-expression language-javascript"}},[t._v("width")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("variant")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("source")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token javascript-expression language-javascript"}},[t._v("sourceImage")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("real")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("frequency")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token javascript-expression language-javascript"}},[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")])]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("real")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("amplitude")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token javascript-expression language-javascript"}},[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")])]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("real")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("time")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token javascript-expression language-javascript"}},[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")])]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NumberAnimation")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" time "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("from")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token javascript-expression language-javascript"}},[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("to")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token javascript-expression language-javascript"}},[t._v("Math"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PI")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("duration")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token javascript-expression language-javascript"}},[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("loops")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token javascript-expression language-javascript"}},[t._v("Animation"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Infinite")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("fragmentShader")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token javascript-expression language-javascript"}},[e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"wave.frag.qsb"')])]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])])])]),e("p",[t._v("The fragment shader takes the properties and calculates the color of each pixel based on the properties.")]),t._v(" "),e("div",{staticClass:"language-frag extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("#version 440\n\nlayout(location=0) in vec2 qt_TexCoord0;\n\nlayout(location=0) out vec4 fragColor;\n\nlayout(std140, binding=0) uniform buf {\n    mat4 qt_Matrix;\n    float qt_Opacity;\n    \n    float frequency;\n    float amplitude;\n    float time;\n} ubuf;\n\nlayout(binding=1) uniform sampler2D source;\n\nvoid main() {\n    vec2 pulse = sin(ubuf.time - ubuf.frequency * qt_TexCoord0);\n    vec2 coord = qt_TexCoord0 + ubuf.amplitude * vec2(pulse.x, -pulse.x);\n    fragColor = texture(source, coord) * ubuf.qt_Opacity;\n}")])])]),e("p",[t._v("The wave calculation is based on a pulse and the texture coordinate manipulation. The pulse equation gives us a sine wave depending on the current time and the used texture coordinate:")]),t._v(" "),e("div",{staticClass:"language-glsl extra-class"},[e("pre",{pre:!0,attrs:{class:"language-glsl"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("vec2")]),t._v(" pulse "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sin")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ubuf"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("time "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" ubuf"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("frequency "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" qt_TexCoord0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("Without the time factor, we would just have a distortion but not a traveling distortion like waves are.")]),t._v(" "),e("p",[t._v("For the color we use the color at a different texture coordinate:")]),t._v(" "),e("div",{staticClass:"language-glsl extra-class"},[e("pre",{pre:!0,attrs:{class:"language-glsl"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("vec2")]),t._v(" coord "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" qt_TexCoord0 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" ubuf"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("amplitude "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("vec2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pulse"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("x"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("pulse"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("x"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("The texture coordinate is influenced by our pulse x-value. The result of this is a moving wave.")]),t._v(" "),e("p",[e("img",{attrs:{src:s(508),alt:"image"}})]),t._v(" "),e("p",[t._v("In this example we use a fragment shader, meaning that we move the pixels inside the texture of the rectangular item. If we wanted the entire item to move as a wave we would have to use a vertex shader.")])])}),[],!1,null,null,null);a.default=n.exports}}]);